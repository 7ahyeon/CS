# 모든 개발자를 위한 HTTP 웹 기본 지식 - 김영한

# 인터넷 통신
- 클라이언트 -인터넷 망(노드들)- 서버

# IP 
- Internet protocol
- 통신을 위해서! 클라이언트와 서버 IP 주소 부여
  - e.g. 클라이언트 : 100.100.100.1 / 서버 : 200.200.200.2
- IP 역할
  - 지정한 IP 주소에 패킷(Packet) 단위 데이터 전달
  - 패킷 Packet : 출발지 IP, 목적지 IP ... + 전송 데이터
- IP 한계
  - 비연결성
    - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷 전송
      - 대상 서버가 패킷을 받을 수 있는 상태인지 모름!
  - 비신뢰성
    - 중간에 패킷이 사라지면?
      - 패킷 소실 (노드 꺼짐 등) 
    - 패킷이 순서대로 안오면?
      - 패킷 전달 순서 문제 발생 (1500byte 이상 - 한번에 전송X 끊어보냄)
        - 내부적인 선택 : 그순간에 빠른 노드 선택 (항상 같지 않음)
        - PDU(Protocol Data Unit) : 프로토콜 데이터 단위
          - 1계층(Physical) : bit, symbol
          - 2계층(Data Link) : frame
          - 3계층(Network) : packet, datagram
          - 4계층(Transport) : segment (e.g. TCP segment)
        - MTU(Maximum Transmission Unit) : 하나의 프레임이나 패킷이 한 번에 전송 가능한 데이터의 크기 (프로토콜에 따라 최대 크기 달라짐)
        - 일반적으로 이더넷을 사용하기 때문에 최대 MTU 사이즈 : 1500byte
          - TCP, IP나 애플리케이션에서 가능한 데이터
          - 이더넷의 헤더나 트레일러는 제외한 것
          - IP/TCP 헤더 제외 1500 - 20 - 20 = 1460byte
            |Ethernet Header|IP Header|TCP Header|TCP Segment|Ethernet Trailer|
            |:--:|:--:|:--:|:--:|:--:|
            |14byte|20byte|20byte|1460byte||
            ||<-|1500byte|->||
  - 프로그램 구분
    - 같은 IP를 사용하는 서버에서 통신하는 애플리케이션이 둘 이상이면?

# TCP
- Transmission Control Protocol
- 전송 제어 프로토콜
- TCP 특징
  - 연결 지향 : TCP 3way handshake (가상 연결) : 연결 먼저 > 데이터 전송
    - 1. SYN 접속 요청 : connect, 클라이언트 -> 서버
    - 2. SYN + ACK 요청 수락 : 클라이언트 <- 서버
    - 3. ACK : 데이터 전송 가능! 클라이언트 -> 서버
    - 4. 데이터 전송
  - 데이터 전달 보증!
    - 1. 데이터 전송 : 클라이언트 -> 서버
    - 2. 데이터 잘 받았음 : 클라이언트 <- 서버
  - 순서 보장
    - 1. 패킷1-2-3 순서로 전송 : 클라이언트 -> 서버
    - 2. 패킷1-3-2 순서로 전송
    - 3. 패킷2-3 다시 보내! : 클라이언트 <- 서버
    - 예외! 서버에서의 최적화도 가능 : 드라이버 같은 곳에서 2-3번 순서 맞춤
- 신뢰할 수 있는 프로토콜!
- 현재는 대부분의 애플리케이션에서 TCP 사용

# UDP
- User Datagram Protocol
- 사용자 데이터그램 프로토콜
- 하얀 도화지! 기능이 거의 없음!
- 장점
  - IP와 거의 같음!
  - 거기에 Port + 체크섬 추가
- 단점
  - 데이터 전달 및 순서 보증되지 않음
  - 애플리케이션에서 추가 작업 필요함

# 인터넷 프로토콜 스택의 4계층
|애플리케이션 계층|HTTP, FTP|
|:--:|:--:|
|전송 계층|TCP, UDP|
|인터넷 계층|IP|
|네트워크 인터페이스 계층|-|

- 프로토콜 계층

|애플리케이션|웹 브라우저 네트워크 게임 채팅 프로그램 <br> SOCKET 라이브러리|
|:--:|:--:|
|OS|TCP UDP <br> IP(Internet Protocol|
|네트워크 인터페이스|LAN 드라이버 LAN 장비 [LAN 카드] -인터넷-> 서버|
  - 메시지 : HTTP + TCP + IP + Ethernet frame(MAC 주소 등)
- TCP/IP 패킷 정보
  - IP 패킷 : 출발지 IP, 목적지 IP etc
  - TCP 세그먼트 : 출발지 Port, 목적지 Port, 전송 제어, 순서, 검증 정보
  - + 전송 데이터
